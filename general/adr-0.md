---
order: 1
title: Концепция ADR
properties:
  - name: Статус
    value:
      - Принято
  - name: Дата
    value:
      - "20240611"
  - name: Подсистема
    value:
      - Документация
---

## Контекст

Архитектура для agile-проектов должна описываться и определяться по-другому. Не все решения принимаются сразу, и далеко не все из них завершаются на старте проекта.

Гибкие методы разработки не противоречат документации сами по себе, а выступают против документации, не несущей ценности. Документы, которые помогают самой команде, могут быть полезны, но только в том случае, если они поддерживаются в актуальном состоянии. Большие документы никогда не обновляются вовремя. Маленькие, модульные документы хотя бы имеют шанс быть актуализированными.

Кроме того, никто не читает большие документы. У большинства разработчиков был хотя бы один проект, где спецификация была больше по объёму (в байтах), чем весь исходный код проекта. Такие документы слишком громоздки, чтобы их открывать, читать или обновлять. Небольшие, легко усваиваемые части информации проще воспринимаются всеми заинтересованными сторонами.

Одна из самых сложных задач в течение жизненного цикла проекта -- отслеживание причин, стоящих за определенными решениями. Новый участник проекта может испытывать недоумение, восторг или раздражение из-за какого-то решения, принятого в прошлом. Без понимания мотивации и последствий у него остается только два варианта:

1. **Слепо принять решение**.

   Такой подход может быть допустим, если решение по-прежнему актуально. Однако, если контекст изменился и решение требует пересмотра, это может привести к проблемам. Если проект накапливает слишком много решений, принятых без должного понимания, команда начинает бояться что-либо менять, и проект рушится под тяжестью собственной сложности.

2. **Слепо изменить его**.

   Это тоже может сработать, если решение действительно нужно отменить. Но если изменить его без понимания мотивации или последствий, можно невольно нанести ущерб общей ценности проекта. (Например, решение могло поддерживать нефункциональные требования, которые еще не тестировались.)

Лучше избегать как слепого принятия, так и бездумного изменения решений.

## Решение

Мы будем вести коллекцию записей о «значимых для архитектуры» решениях: тех, которые влияют на структуру, нефункциональные характеристики, зависимости, интерфейсы или методы реализации.

Архитектурная запись о принятии решений (ADR) представляет собой короткий текстовый файл в формате, похожем на александрийский паттерн. (Хотя сами решения не обязательно являются паттернами, они имеют общую черту -- балансировку сил.) Каждая запись описывает набор факторов и одно решение в ответ на эти факторы. Важно отметить, что ключевым элементом записи является само решение, поэтому одни и те же факторы могут упоминаться в нескольких ADR.

ADR будут храниться в репозитории проекта в каталоге `doc/arch/../adr-NNN.md`.

Для записи следует использовать легкий язык форматирования текста, например, Markdown.

ADR будут пронумерованы последовательно и монотонно. Номера не будут повторяться.

Если решение будет отменено, старая запись сохранится, но будет помечена как устаревшая. Это по-прежнему важно для понимания того, что такое решение было принято, но оно больше не актуально.

Формат будет включать всего несколько частей, чтобы каждый документ был легко воспринимаемым. Вот основные части формата:

-  **Заголовок**: Документ имеет короткое название в виде существительного словосочетания. Например, «ADR 1: Развертывание на Ruby on Rails 3.0.10» или «ADR 9: LDAP для многопользовательской интеграции».

-  **Статус**: Решение может находиться в статусе «предложено», если оно еще не согласовано с заинтересованными сторонами проекта, или «принято», если одобрено. Если последующее ADR изменяет или отменяет решение, оно может быть помечено как «устаревшее» или «замененное» с указанием на его замену.

-  **Контекст**: Этот раздел описывает текущие факторы, включая технологические, политические, социальные и локальные для проекта. Эти факторы, вероятно, находятся в конфликте и должны быть отмечены как таковые. Язык в этом разделе должен быть нейтральным и описывать факты.

-  **Решение**: В этом разделе описывается наш ответ на эти факторы. Формулировка должна быть в полных предложениях с использованием активного залога: «Мы будем…».

-  **Последствия**: В этом разделе описывается контекст после применения решения. Здесь должны быть перечислены все последствия -- не только «положительные». Конкретное решение может иметь положительные, отрицательные и нейтральные последствия, и все они должны быть зафиксированы, так как влияют на команду и проект в будущем.

Весь документ должен занимать одну-две страницы. Мы будем писать каждую ADR так, как если бы это был диалог с будущим разработчиком. Это требует хорошего стиля письма, с полными предложениями, организованными в абзацы. Использование маркеров допускается только для визуальной ясности, но не для оправдания фрагментарных предложений.

## Последствия

Один ADR описывает одно значимое решение для конкретного проекта. Это должно быть решение, влияющее на то, как будет развиваться остальная часть проекта.

Последствия одного ADR с большой вероятностью станут контекстом для последующих ADR. Решения на крупном уровне создают пространство для вписывания более мелких решений.

Разработчики и заинтересованные стороны проекта могут видеть ADR, даже если состав команды со временем меняется.

Мотивация, стоящая за предыдущими решениями, становится доступной для всех -- как для текущих участников проекта, так и для будущих. Никому не придется ломать голову в попытках понять: «О чем они думали?» Моменты, когда стоит пересмотреть старые решения, будут очевидны благодаря изменениям в контексте проекта.

---

Источник: <https://cognitect.com/blog/2011/11/15/documenting-architecture-decisions>